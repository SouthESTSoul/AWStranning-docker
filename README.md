

#### 本项目的网络架构

![截屏2021-04-21 下午10.02.59](https://i.loli.net/2021/04/21/HsoYl1N5TafXinJ.png)



### docker网络模式



#### Host模式

基于宿主机的网络，它的网络跟宿主机的网络一模一样，那是因为，在创建这个容器之初、并没有对它的Net网络栈进行隔离，而是直接使用的宿主机的网络，此模式没有网络隔离性， 同时会引起网络资源的竞争与冲突。
使用场景：性能较好，但不便之处是灵活性不高，此模式没有网络隔离性，容器与宿主机出现端口冲突问题。

#### Bridge模式

bridge模式是默认模式，此模式会为每一个容器分配Network Namespace、 设置IP等， 并将一个主机上的Docker容器连接到一个虚	拟网桥上。

通过这样的桥接方法宿主机上的所有容器都处于同一个二层网络中，这样使得容器与容器以及容器与宿主机之间能够互相通信。而不会有余宿主机端口冲突的问题

![img](https://i.loli.net/2021/04/22/OHlx7vjSqiwu938.jpg)

#### Container模式

这个模式指定新创建的容器和已经存在的一个容器共享一个Network Namespace，而不是和宿主机共享，新创建的容器不会创建自己的网卡，配置自己的IP，而是和一个指定的容器共享IP、端口范围等
使用场景：在于可以将一个应用的多个组件放在不同的容器趾， 这些容器配成container模式的网络， 这样它们可以作为一个整体对外提供服务。 同时， 这种模式也降低了容器间的隔离性。

#### None模式

什么都没有的网络，Docker容器拥有自己的Network Namespace， 但是， 并不为Docker容器进行任何网络配置。 也就是说， 这个Docker容器没有网卡、 IP、 路由等信息。 需要我们自己为Docker容器添加网卡、 配置IP等，给用户很高的自由度来配置网络环境
使用场景：容器并不需要网络（例如只需要写磁盘卷的批处理任务）。



### 简要描述AUFS文件系统的特点以及优缺点，如何解决性能问题

1. AUFS是一种联合文件系统，它把若干目录按照顺序和权限mount为一个目录并呈现出来
2. 默认情况下，只有第一层目录是可写的，其他目录都只是可读
3. 增加文件：新添加的文件存在于最上层的目录下
4. 删除文件：利用writeout机制，通过在最上层的目录建立对应下层文件的writeout隐藏文件实现
5. 修改文件：使用CoW（Copy on Write）特性，将需要修改的文件拷贝到最上层目录下再进行修改
6. 节省空间：CoW特性允许在多个容器之间共享分层，从而可以减少物理空间占用
7. 查找文件：层数多了之后查找文件的性能会出现下降
8. 性能：由于CoW特性，在第一次写入大型文件时会出现延迟

如何解决：

1.使用SSD

2.写负载高时使用volume



### 简要描述Docker和虚拟机的对比

1. docker需要的资源更少，docker在操作系统级别进行虚拟化，docker容器和内核交互，几乎没有性能损耗，性能优于通过Hypervisor层与内核层的虚拟化所以docker更轻量，docker的架构可以共用一个内核与共享应用程序库，所占内存极小。同样的硬件环境，Docker运行的镜像数远多于虚拟机数量。对系统的利用率非常高
2. 与虚拟机相比，docker隔离性更弱，docker属于进程之间的隔离，虚拟机可实现系统级别隔离；
3. 安全性： docker的安全性也更弱。虚拟机利用如Intel的VT-d和VT-x的ring-1硬件隔离技术，这种隔离技术可以防止虚拟机突破和彼此交互，而容器至今还没有任何形式的硬件隔离，这使得容器容易受到攻击。
4. 快速创建、删除：虚拟化创建是分钟级别的，Docker容器创建是秒级别的。



